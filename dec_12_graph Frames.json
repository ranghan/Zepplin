{"paragraphs":[{"text":"%dep\nz.load(\"graphframes:graphframes:0.5.0-spark2.1-s_2.10\")","user":"anonymous","dateUpdated":"2018-12-09T09:20:50-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544375833753_1829366580","id":"20181209-091713_196825984","dateCreated":"2018-12-09T09:17:13-0800","dateStarted":"2018-12-09T09:20:50-0800","dateFinished":"2018-12-09T09:21:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25439"},{"title":"Load The Required Libraries","text":" import org.graphframes._","user":"anonymous","dateUpdated":"2018-12-09T09:21:37-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544375718054_-199102834","id":"20181209-091518_1297347046","dateCreated":"2018-12-09T09:15:18-0800","dateStarted":"2018-12-09T09:21:37-0800","dateFinished":"2018-12-09T09:22:03-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25440"},{"title":"Load Data","text":"val rawStation = sc.textFile(\"file:///home/data/station_data.csv\")\nval rawTrip = sc.textFile(\"file:///home/data/trip_data.csv\")","user":"anonymous","dateUpdated":"2018-12-09T09:23:49-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544375823137_-2022651983","id":"20181209-091703_1470329000","dateCreated":"2018-12-09T09:17:03-0800","dateStarted":"2018-12-09T09:23:49-0800","dateFinished":"2018-12-09T09:23:59-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25441"},{"text":"rawStation.first()\nrawTrip.first()","user":"anonymous","dateUpdated":"2018-12-09T09:24:50-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=3","http://192.168.1.125:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544376229927_804308365","id":"20181209-092349_1255673683","dateCreated":"2018-12-09T09:23:49-0800","dateStarted":"2018-12-09T09:24:50-0800","dateFinished":"2018-12-09T09:24:54-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25442"},{"title":"Case classes","text":"case class Station(station_id : Int, name :String, lat : Double, lg : Double, dockcount : Int, landmark : String, installation : String)\r\ncase class Trip(Trip_ID : String, Duration : String, Start_Date : String, Start_Station :String, Start_Terminal : String, End_Date : String, End_Station : String, \r\nEnd_Terminal : String, Bike_no : String, Subscriber_Type : String, Zip_Code : String)","user":"anonymous","dateUpdated":"2018-12-09T09:27:34-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376250116_334965670","id":"20181209-092410_1778117380","dateCreated":"2018-12-09T09:24:10-0800","dateStarted":"2018-12-09T09:27:34-0800","dateFinished":"2018-12-09T09:27:38-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25443"},{"title":"create Dataframe","text":"val station_split = rawStation.map(x => x.split(\",\"))\r\nval stationRDD = station_split.filter(x => x(0) != \"station_id\")\r\n\r\nval trip_split = rawTrip.map(x => x.split(\",\"))\r\nval tripRDD = trip_split.filter(x => x(0) != \"Trip ID\")\r\n\r\nval stationDF =  stationRDD.map(x => Station(x(0).toInt, x(1), x(2).toDouble, x(3).toDouble, x(4).toInt, x(5), x(6))).toDF()\r\n\r\nval tripDF = tripRDD.map(x => Trip(x(0), x(1), x(2), x(3), x(4), x(5), x(6), x(7), x(8), x(9), x(10))).toDF()\r\n","user":"anonymous","dateUpdated":"2018-12-09T09:27:38-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376364189_-1096080790","id":"20181209-092604_158190469","dateCreated":"2018-12-09T09:26:04-0800","dateStarted":"2018-12-09T09:27:38-0800","dateFinished":"2018-12-09T09:27:50-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25444"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376423423_-1603201895","id":"20181209-092703_1765365424","dateCreated":"2018-12-09T09:27:03-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25445","dateUpdated":"2018-12-09T09:33:10-0800","dateFinished":"2018-12-09T09:33:13-0800","dateStarted":"2018-12-09T09:33:10-0800","title":"Explore stationDF","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- station_id: integer (nullable = true)\n |-- name: string (nullable = true)\n |-- lat: double (nullable = true)\n |-- lg: double (nullable = true)\n |-- dockcount: integer (nullable = true)\n |-- landmark: string (nullable = true)\n |-- installation: string (nullable = true)\n\n"}]},"text":"stationDF.printSchema()"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376790085_-1865549451","id":"20181209-093310_607935940","dateCreated":"2018-12-09T09:33:10-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25985","text":"val ver = stationDF.withColumnRenamed(\"name\", \"id\")","dateUpdated":"2018-12-09T09:34:46-0800","dateFinished":"2018-12-09T09:34:31-0800","dateStarted":"2018-12-09T09:34:28-0800","title":"Rename Name ==> id","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ver: org.apache.spark.sql.DataFrame = [station_id: int, id: string ... 5 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376920118_-382002264","id":"20181209-093520_2059025390","dateCreated":"2018-12-09T09:35:20-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26197","text":"tripDF.printSchema()","dateUpdated":"2018-12-09T09:35:27-0800","dateFinished":"2018-12-09T09:35:30-0800","dateStarted":"2018-12-09T09:35:28-0800","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Trip_ID: string (nullable = true)\n |-- Duration: string (nullable = true)\n |-- Start_Date: string (nullable = true)\n |-- Start_Station: string (nullable = true)\n |-- Start_Terminal: string (nullable = true)\n |-- End_Date: string (nullable = true)\n |-- End_Station: string (nullable = true)\n |-- End_Terminal: string (nullable = true)\n |-- Bike_no: string (nullable = true)\n |-- Subscriber_Type: string (nullable = true)\n |-- Zip_Code: string (nullable = true)\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376868618_290760881","id":"20181209-093428_1106773251","dateCreated":"2018-12-09T09:34:28-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26088","dateUpdated":"2018-12-09T09:36:32-0800","dateFinished":"2018-12-09T09:36:34-0800","dateStarted":"2018-12-09T09:36:32-0800","title":"Rename : start_station => src; End_station => dst","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edge: org.apache.spark.sql.DataFrame = [Trip_ID: string, Duration: string ... 9 more fields]\n"}]},"text":"val edge = tripDF.withColumnRenamed(\"Start_Station\", \"src\").withColumnRenamed(\"End_Station\", \"dst\")"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544376992257_-1282498476","id":"20181209-093632_207534978","dateCreated":"2018-12-09T09:36:32-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26294","text":"val stationGraph = GraphFrame(ver, edge)","dateUpdated":"2018-12-09T09:37:49-0800","dateFinished":"2018-12-09T09:37:52-0800","dateStarted":"2018-12-09T09:37:49-0800","title":"Build Graph","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"stationGraph: org.graphframes.GraphFrame = GraphFrame(v:[id: string, station_id: int ... 5 more fields], e:[src: string, dst: string ... 9 more fields])\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377069256_-1398713495","id":"20181209-093749_2078822358","dateCreated":"2018-12-09T09:37:49-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26397","dateUpdated":"2018-12-09T09:39:37-0800","dateFinished":"2018-12-09T09:39:45-0800","dateStarted":"2018-12-09T09:39:37-0800","title":"Number of Stations","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res24: Long = 70\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"text":"stationGraph.vertices.count()"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377177371_110287092","id":"20181209-093937_1347321479","dateCreated":"2018-12-09T09:39:37-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26502","dateUpdated":"2018-12-09T09:41:36-0800","dateFinished":"2018-12-09T09:41:56-0800","dateStarted":"2018-12-09T09:41:36-0800","title":"Number of Trips","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res32: Long = 1631\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"text":"stationGraph.edges.select(\"src\",\"dst\").distinct().count()"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377212155_409725998","id":"20181209-094012_1417884708","dateCreated":"2018-12-09T09:40:12-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26625","dateUpdated":"2018-12-09T09:43:29-0800","dateFinished":"2018-12-09T09:43:38-0800","dateStarted":"2018-12-09T09:43:29-0800","title":"Trip from one station to another","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------------+---------------------------------------+-----+\n|src                                    |dst                                    |count|\n+---------------------------------------+---------------------------------------+-----+\n|Townsend at 7th                        |San Francisco Caltrain 2 (330 Townsend)|1140 |\n|Harry Bridges Plaza (Ferry Building)   |Embarcadero at Sansome                 |1003 |\n|San Francisco Caltrain 2 (330 Townsend)|Townsend at 7th                        |906  |\n|2nd at Townsend                        |Harry Bridges Plaza (Ferry Building)   |860  |\n|Embarcadero at Sansome                 |Steuart at Market                      |856  |\n+---------------------------------------+---------------------------------------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"text":"stationGraph.edges.groupBy(\"src\", \"dst\").count().sort($\"count\".desc).show(5, false)"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377382082_-135862841","id":"20181209-094302_2050747388","dateCreated":"2018-12-09T09:43:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26834","text":"// spark-shell --packages graphframes:graphframes:0.3.0-spark1.6-s_2.10","dateUpdated":"2018-12-09T09:49:21-0800","dateFinished":"2018-12-09T09:49:23-0800","dateStarted":"2018-12-09T09:49:21-0800","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377817282_-892418224","id":"20181209-095017_868080371","dateCreated":"2018-12-09T09:50:17-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27330","text":"sc.textFile(\"file:///home/data/people.json\").collect().foreach(println)","dateUpdated":"2018-12-09T09:50:40-0800","dateFinished":"2018-12-09T09:50:44-0800","dateStarted":"2018-12-09T09:50:40-0800","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\"name\":\"Michael\"}\n{\"name\":\"David\",\"age\":12}\n{\"name\":\"Steve\",\"age\":14}\n{\"name\":\"James\",\"age\":18}\n{\"name\":\"Mark\",\"age\":30}\n{\"name\":\"Sachin\",\"age\":35}\n{\"name\":\"Rahul\",\"age\":24}\n{\"name\":\"Stephen\",\"age\":25}\n{\"name\":\"Brian\",\"age\":26}\n{\"name\":\"Chris\",\"age\":28}\n{\"name\":\"Kevin\",\"age\":51}\n{\"name\":\"Andrew\",\"age\":52}\n{\"name\":\"Joss\",\"age\":78}\n{\"name\":\"Henry\",\"age\":34}\n{\"name\":\"Aaron\"}\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377761437_1745534397","id":"20181209-094921_360873777","dateCreated":"2018-12-09T09:49:21-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26993","text":"val df = spark.read.json(\"file:///home/data/people.json\")","dateUpdated":"2018-12-09T09:49:59-0800","dateFinished":"2018-12-09T09:50:03-0800","dateStarted":"2018-12-09T09:49:59-0800","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [age: bigint, name: string]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377788211_-768887383","id":"20181209-094948_1500747986","dateCreated":"2018-12-09T09:49:48-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27074","text":"df.show()","dateUpdated":"2018-12-09T09:50:04-0800","dateFinished":"2018-12-09T09:50:06-0800","dateStarted":"2018-12-09T09:50:04-0800","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  12|  David|\n|  14|  Steve|\n|  18|  James|\n|  30|   Mark|\n|  35| Sachin|\n|  24|  Rahul|\n|  25|Stephen|\n|  26|  Brian|\n|  28|  Chris|\n|  51|  Kevin|\n|  52| Andrew|\n|  78|   Joss|\n|  34|  Henry|\n|null|  Aaron|\n+----+-------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544377804387_-1860718775","id":"20181209-095004_637839887","dateCreated":"2018-12-09T09:50:04-0800","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27211"}],"name":"dec_12_graph Frames","id":"2DXMPMH7E","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}