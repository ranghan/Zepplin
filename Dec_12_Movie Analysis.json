{"paragraphs":[{"title":"Load The Data","text":"val input = sc.textFile(\"file:///home/data/Movies.csv\")","user":"anonymous","dateUpdated":"2018-12-08T06:09:22-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544276858053_-27811828","id":"20181208-054738_356365866","dateCreated":"2018-12-08T05:47:38-0800","dateStarted":"2018-12-08T06:09:05-0800","dateFinished":"2018-12-08T06:09:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27"},{"text":"input.first()","user":"anonymous","dateUpdated":"2018-12-08T06:13:04-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544277599081_-1142346827","id":"20181208-055959_1138637903","dateCreated":"2018-12-08T05:59:59-0800","dateStarted":"2018-12-08T06:13:04-0800","dateFinished":"2018-12-08T06:13:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:28"},{"title":"Schema : Case class","text":"case class Movie(year:Int, length:Int, title:String, subject:String, actor:String, actress:String, director:String, polularity:Int, award:String)","user":"anonymous","dateUpdated":"2018-12-08T06:22:02-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544278155414_1912066738","id":"20181208-060915_801362821","dateCreated":"2018-12-08T06:09:15-0800","dateStarted":"2018-12-08T06:22:02-0800","dateFinished":"2018-12-08T06:22:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29"},{"title":"Create DataFrame","text":"val moviesDF = input.map(line => line.split(\",\")).map(x => Movie(x(0).toInt, x(1).toInt, x(2), x(3), x(4), x(5), x(6), x(7).toInt, x(8))).toDF()","user":"anonymous","dateUpdated":"2018-12-08T06:25:40-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544278922744_-2109040530","id":"20181208-062202_1283496498","dateCreated":"2018-12-08T06:22:02-0800","dateStarted":"2018-12-08T06:25:40-0800","dateFinished":"2018-12-08T06:25:53-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:30"},{"title":"Display Data","text":"moviesDF.show(2)","user":"anonymous","dateUpdated":"2018-12-08T06:28:21-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544279140545_1963744615","id":"20181208-062540_458316907","dateCreated":"2018-12-08T06:25:40-0800","dateStarted":"2018-12-08T06:28:21-0800","dateFinished":"2018-12-08T06:28:25-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:31"},{"title":"How many horror movies were there between year 1952 and 1968","text":"moviesDF.filter($\"year\" >= 1952 && $\"year\" <= 1968 && $\"subject\" === \"Horror\").show()","user":"anonymous","dateUpdated":"2018-12-08T06:38:49-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544279166462_-1665280836","id":"20181208-062606_372431591","dateCreated":"2018-12-08T06:26:06-0800","dateStarted":"2018-12-08T06:38:50-0800","dateFinished":"2018-12-08T06:38:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32"},{"title":"How many movies got released each year.","text":"moviesDF.groupBy(\"year\").count().show(5)","user":"anonymous","dateUpdated":"2018-12-08T06:46:45-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=5","http://192.168.1.125:4040/jobs/job?id=6","http://192.168.1.125:4040/jobs/job?id=7","http://192.168.1.125:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544279917444_-965640334","id":"20181208-063837_840453484","dateCreated":"2018-12-08T06:38:37-0800","dateStarted":"2018-12-08T06:46:46-0800","dateFinished":"2018-12-08T06:46:53-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33"},{"title":"Top 3 years with most movies","text":"moviesDF.groupBy(\"year\").count().sort($\"count\".desc).show(3)","user":"anonymous","dateUpdated":"2018-12-08T06:52:14-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544280385814_-152927569","id":"20181208-064625_1346776554","dateCreated":"2018-12-08T06:46:25-0800","dateStarted":"2018-12-08T06:52:14-0800","dateFinished":"2018-12-08T06:52:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:34"},{"text":"moviesDF.createOrReplaceTempView(\"movie\")","user":"anonymous","dateUpdated":"2018-12-08T06:55:01-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544280873175_255562283","id":"20181208-065433_1420621493","dateCreated":"2018-12-08T06:54:33-0800","dateStarted":"2018-12-08T06:55:01-0800","dateFinished":"2018-12-08T06:55:06-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:35"},{"text":"spark.sql(\"select year, count(*) as count from movie group by year order by count desc\").show(3)","user":"anonymous","dateUpdated":"2018-12-08T06:55:49-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544280734795_1902788274","id":"20181208-065214_854969361","dateCreated":"2018-12-08T06:52:14-0800","dateStarted":"2018-12-08T06:55:50-0800","dateFinished":"2018-12-08T06:55:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36"},{"title":"How many movies with length > 100","text":"moviesDF.filter($\"length\" > 100).count()","user":"anonymous","dateUpdated":"2018-12-08T06:59:36-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544280934646_2051606939","id":"20181208-065534_921241832","dateCreated":"2018-12-08T06:55:34-0800","dateStarted":"2018-12-08T06:59:36-0800","dateFinished":"2018-12-08T06:59:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37"},{"title":"Top 5 actors with most movies","text":"moviesDF.groupBy(\"actor\").count().sort($\"count\".desc).show(5)","user":"anonymous","dateUpdated":"2018-12-08T07:06:15-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=13"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544281176128_-1852706588","id":"20181208-065936_469132760","dateCreated":"2018-12-08T06:59:36-0800","dateStarted":"2018-12-08T07:06:15-0800","dateFinished":"2018-12-08T07:06:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:38"},{"title":"Top 3 categories with most movies","text":"moviesDF.groupBy(\"subject\").count().sort($\"count\".desc).show(3)","user":"anonymous","dateUpdated":"2018-12-08T07:10:39-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544281378865_-270871683","id":"20181208-070258_2086400065","dateCreated":"2018-12-08T07:02:58-0800","dateStarted":"2018-12-08T07:10:39-0800","dateFinished":"2018-12-08T07:10:49-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39"},{"title":"Top 3 years with Drama Movies","text":"moviesDF.filter($\"subject\" === \"Drama\").groupBy(\"year\").count().sort($\"count\".desc).show(3)","user":"anonymous","dateUpdated":"2018-12-08T07:14:51-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544281839098_43120776","id":"20181208-071039_139258244","dateCreated":"2018-12-08T07:10:39-0800","dateStarted":"2018-12-08T07:14:52-0800","dateFinished":"2018-12-08T07:14:59-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:40"},{"title":"Find the longest movie in each category","text":"// Title, Subject, Length\nval longcat = moviesDF.groupBy(\"subject\").agg(max(\"length\").alias(\"longest\"))\nval longmovie = moviesDF.join(longcat, moviesDF(\"length\") === longcat(\"longest\") and moviesDF(\"subject\") === longcat(\"subject\"))\nlongmovie.select(moviesDF(\"title\"), moviesDF(\"subject\"), longcat(\"longest\")).show(5)","user":"anonymous","dateUpdated":"2018-12-08T07:26:55-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=20","http://192.168.1.125:4040/jobs/job?id=21","http://192.168.1.125:4040/jobs/job?id=22","http://192.168.1.125:4040/jobs/job?id=23"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544282073062_-1386180294","id":"20181208-071433_1482000880","dateCreated":"2018-12-08T07:14:33-0800","dateStarted":"2018-12-08T07:26:55-0800","dateFinished":"2018-12-08T07:27:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41"},{"title":"Most Un-lucky Director. Director with most movies with no awards.","text":"moviesDF.filter($\"award\" === \"No\").groupBy(\"director\").count().sort($\"count\".desc).show(1)","user":"anonymous","dateUpdated":"2018-12-08T07:33:48-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544282663454_779410604","id":"20181208-072423_507387972","dateCreated":"2018-12-08T07:24:23-0800","dateStarted":"2018-12-08T07:33:49-0800","dateFinished":"2018-12-08T07:33:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42"},{"title":"Read from HIVE Table","text":"val df = spark.sql(\"select * from HIVE_DB.HIVE_Table\")","user":"anonymous","dateUpdated":"2018-12-08T07:37:44-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544282670879_-2135099851","id":"20181208-072430_1626990595","dateCreated":"2018-12-08T07:24:30-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:43"}],"name":"Dec_12_Movie Analysis","id":"2DXKA1KRG","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}