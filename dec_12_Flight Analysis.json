{"paragraphs":[{"title":"Load required Libraries","text":"import org.apache.spark.graphx._\nimport org.apache.spark.rdd.RDD\nimport scala.util.MurmurHash","user":"anonymous","dateUpdated":"2018-12-09T07:15:24-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544367998864_-1862994014","id":"20181209-070638_643985711","dateCreated":"2018-12-09T07:06:38-0800","dateStarted":"2018-12-09T07:15:24-0800","dateFinished":"2018-12-09T07:15:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:29466"},{"title":"Read the Data","text":"val input = sc.textFile(\"file:///home/data/flight.csv\")","user":"anonymous","dateUpdated":"2018-12-09T07:06:29-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544367931075_740703842","id":"20181209-070531_1096938691","dateCreated":"2018-12-09T07:05:31-0800","dateStarted":"2018-12-09T07:06:29-0800","dateFinished":"2018-12-09T07:06:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29467"},{"title":"Sample Data","text":"input.first()","user":"anonymous","dateUpdated":"2018-12-09T07:16:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=46"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544367970416_-333819176","id":"20181209-070610_1108880367","dateCreated":"2018-12-09T07:06:10-0800","dateStarted":"2018-12-09T07:15:41-0800","dateFinished":"2018-12-09T07:15:44-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29468"},{"title":"case Class","text":"case class Flight(origin : String, Dest : String)","user":"anonymous","dateUpdated":"2018-12-09T07:16:53-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544368566173_-239832640","id":"20181209-071606_1813494768","dateCreated":"2018-12-09T07:16:06-0800","dateStarted":"2018-12-09T07:16:53-0800","dateFinished":"2018-12-09T07:16:57-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29469"},{"title":"Create dataFrame","text":"val flightDF = input.map(x => x.split(\",\")).map(x => Flight(x(16), x(17))).toDF().filter($\"origin\" !== \"Origin\")\n// OR : ||","user":"anonymous","dateUpdated":"2018-12-09T07:26:06-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544367979107_-1755499515","id":"20181209-070619_710319192","dateCreated":"2018-12-09T07:06:19-0800","dateStarted":"2018-12-09T07:18:49-0800","dateFinished":"2018-12-09T07:18:53-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29470"},{"text":".show(4)","user":"anonymous","dateUpdated":"2018-12-09T08:15:24-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=48"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544368662016_-1950782163","id":"20181209-071742_125248307","dateCreated":"2018-12-09T07:17:42-0800","dateStarted":"2018-12-09T07:18:58-0800","dateFinished":"2018-12-09T07:19:01-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29471"},{"title":"Airport Codes","text":"val air_codes = flightDF.select($\"origin\".alias(\"codes\")).unionAll(flightDF.select($\"dest\")).distinct()","user":"anonymous","dateUpdated":"2018-12-09T07:32:28-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544368673733_1027074956","id":"20181209-071753_1501742883","dateCreated":"2018-12-09T07:17:53-0800","dateStarted":"2018-12-09T07:32:28-0800","dateFinished":"2018-12-09T07:32:32-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29472"},{"text":"air_codes.count()","user":"anonymous","dateUpdated":"2018-12-09T07:32:43-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=49"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544369548811_1227863302","id":"20181209-073228_1521356575","dateCreated":"2018-12-09T07:32:28-0800","dateStarted":"2018-12-09T07:32:43-0800","dateFinished":"2018-12-09T07:32:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29473"},{"title":"Vertex RDD","text":"// RDD[(Long, String)]\nval vRDD_temp = air_codes.rdd.map(x => x(0).toString)\nval vRDD = vRDD_temp.map(x => (MurmurHash.stringHash(x).toLong, x))","user":"anonymous","dateUpdated":"2018-12-09T08:13:05-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544369558894_767682732","id":"20181209-073238_1272971155","dateCreated":"2018-12-09T07:32:38-0800","dateStarted":"2018-12-09T08:13:05-0800","dateFinished":"2018-12-09T08:13:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29474"},{"title":"Edge RDD","text":"val eRDD_temp = flightDF.rdd.map(x => (\n                                    (MurmurHash.stringHash(x(0).toString) ,MurmurHash.stringHash(x(1).toString)), 1)\n                            ).reduceByKey((x,y) => x + y)","user":"anonymous","dateUpdated":"2018-12-09T08:26:06-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544369755152_-924936472","id":"20181209-073555_1257104887","dateCreated":"2018-12-09T07:35:55-0800","dateStarted":"2018-12-09T08:26:06-0800","dateFinished":"2018-12-09T08:26:08-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29475"},{"text":"eRDD_temp.take(3).foreach(println)","user":"anonymous","dateUpdated":"2018-12-09T08:26:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=73"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544370085459_143497739","id":"20181209-074125_1695801112","dateCreated":"2018-12-09T07:41:25-0800","dateStarted":"2018-12-09T08:26:13-0800","dateFinished":"2018-12-09T08:26:19-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29476"},{"title":"RDD[((Int, Int), Int)] ==> RDD[Edge]","text":"//      ((-1060168684,1190362929),31)\nval eRDD = eRDD_temp.map(x => Edge(x._1._1, x._1._2, x._2))","user":"anonymous","dateUpdated":"2018-12-09T08:29:31-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544372775082_-1641972792","id":"20181209-082615_460403835","dateCreated":"2018-12-09T08:26:15-0800","dateStarted":"2018-12-09T08:29:32-0800","dateFinished":"2018-12-09T08:29:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29477"},{"title":"Create Graph","text":"val graph = Graph(vRDD,eRDD)","user":"anonymous","dateUpdated":"2018-12-09T08:30:31-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544372129317_111895306","id":"20181209-081529_830871243","dateCreated":"2018-12-09T08:15:29-0800","dateStarted":"2018-12-09T08:30:31-0800","dateFinished":"2018-12-09T08:30:33-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:29478"},{"text":"/* x : ((-1060168684,1190362929),31)\nx._1 : (-1060168684,1190362929)\nx._1._1 : 1060168684\nx._1._2 : 1190362929\nx._2 : 31\n*/\n","user":"anonymous","dateUpdated":"2018-12-09T08:38:33-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1544372682571_375482404","id":"20181209-082442_1623680258","dateCreated":"2018-12-09T08:24:42-0800","dateStarted":"2018-12-09T08:38:33-0800","dateFinished":"2018-12-09T08:38:34-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29479"},{"title":"How Many airports do we have in this Graph?","text":"graph.vertices.count()","user":"anonymous","dateUpdated":"2018-12-09T08:40:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res190: Long = 90\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=74"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544373513293_1547555582","id":"20181209-083833_155540290","dateCreated":"2018-12-09T08:38:33-0800","dateStarted":"2018-12-09T08:40:00-0800","dateFinished":"2018-12-09T08:40:15-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29480"},{"title":"How many Unique Routes/Flights do we have?","text":"graph.edges.count()","user":"anonymous","dateUpdated":"2018-12-09T08:41:25-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res192: Long = 1009\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=75"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544373600106_146645037","id":"20181209-084000_102868486","dateCreated":"2018-12-09T08:40:00-0800","dateStarted":"2018-12-09T08:41:25-0800","dateFinished":"2018-12-09T08:41:27-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29481"},{"title":"What are the top 10 busiest Routes","text":"graph.triplets.sortBy(x => x.attr, false).take(10).foreach(println)","user":"anonymous","dateUpdated":"2018-12-09T08:56:07-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"((145517976,HOU),(973200996,DAL),762)\n((973200996,DAL),(145517976,HOU),752)\n((611026873,OAK),(2085087141,LAX),562)\n((2085087141,LAX),(611026873,OAK),554)\n((460935696,LAS),(-1363523055,PHX),516)\n((-1363523055,PHX),(460935696,LAS),512)\n((1993840324,SAN),(611026873,OAK),496)\n((611026873,OAK),(1993840324,SAN),491)\n((611026873,OAK),(-486956020,BUR),466)\n((-486956020,BUR),(611026873,OAK),449)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=78"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544373685825_1966168858","id":"20181209-084125_2060101967","dateCreated":"2018-12-09T08:41:25-0800","dateStarted":"2018-12-09T08:46:51-0800","dateFinished":"2018-12-09T08:46:53-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29482"},{"text":"(graph.triplets.sortBy(x => x.attr, false)\n    .map(x => \"There were \" + x.attr.toString + \" flights from \" + x.srcAttr + \" to \" + x.dstAttr + \".\")\n    .take(10).foreach(println))","user":"anonymous","dateUpdated":"2018-12-09T08:49:25-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"There were 762 flights from HOU to DAL.\nThere were 752 flights from DAL to HOU.\nThere were 562 flights from OAK to LAX.\nThere were 554 flights from LAX to OAK.\nThere were 516 flights from LAS to PHX.\nThere were 512 flights from PHX to LAS.\nThere were 496 flights from SAN to OAK.\nThere were 491 flights from OAK to SAN.\nThere were 466 flights from OAK to BUR.\nThere were 449 flights from BUR to OAK.\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544373921204_771135821","id":"20181209-084521_1968085052","dateCreated":"2018-12-09T08:45:21-0800","dateStarted":"2018-12-09T08:49:25-0800","dateFinished":"2018-12-09T08:49:29-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29483"},{"title":"What are the top 10 least busiest Routes","text":"(graph.triplets.sortBy(x => x.attr)\n    .map(x => \"There were \" + x.attr.toString + \" flights from \" + x.srcAttr + \" to \" + x.dstAttr + \".\")\n    .take(10).foreach(println))","user":"anonymous","dateUpdated":"2018-12-09T08:58:04-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"There were 1 flights from ROC to EWR.\nThere were 1 flights from OMA to ABQ.\nThere were 1 flights from IAH to ABQ.\nThere were 1 flights from IAH to LBB.\nThere were 1 flights from IAH to STL.\nThere were 1 flights from IAH to RIC.\nThere were 1 flights from IAH to SLC.\nThere were 1 flights from IAH to JAX.\nThere were 1 flights from IAH to BNA.\nThere were 1 flights from IAH to SAV.\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.125:4040/jobs/job?id=80"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1544374159659_-736319755","id":"20181209-084919_1015240437","dateCreated":"2018-12-09T08:49:19-0800","dateStarted":"2018-12-09T08:58:04-0800","dateFinished":"2018-12-09T08:58:07-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29484"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544374684279_-24561350","id":"20181209-085804_1728906175","dateCreated":"2018-12-09T08:58:04-0800","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:29485"}],"name":"dec_12_Flight Analysis","id":"2DWG9DRMT","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}